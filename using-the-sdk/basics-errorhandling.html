<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Error handling | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Error handling | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/basics-errorhandling.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="error-handling">Error handling</h1>

<p>PnP Core SDK, like any other library, will throw exceptions when something unexpected happens. Typically exceptions are throw due to failing service calls or configuration mistakes. PnP Core SDK uses different exception types allowing you to have more control over the exception.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext
}
</code></pre>
<h2 id="what-type-of-exceptions-are-thrown-by-pnp-core-sdk">What type of exceptions are thrown by PnP Core SDK</h2>
<p>Exceptions being thrown can be grouped into a number of buckets:</p>
<ul>
<li>Standard .NET exceptions (e.g. <code>ArgumentNullException</code>, <code>ArgumentOutOfRangeException</code>, <code>InvalidCastException</code>, <code>InvalidOperationException</code>, <code>ApplicationException</code>, ...) when validating user input and running</li>
<li>Standard .NET exceptions for currently unsupported features (e.g. <code>NotSupportedException</code>, <code>NotImplementedException</code>)</li>
<li>PnP Core SDK specific exceptions for general SDK failures: <code>ClientException</code></li>
<li>PnP Core SDK specific exceptions for authentication failures: <code>AuthenticationException</code></li>
<li>PnP Core SDK specific exceptions for service calls:
<ul>
<li>For failing SharePoint REST calls: <code>SharePointRestServiceException</code></li>
<li>For failing Microsoft Graph calls: <code>MicrosoftGraphServiceException</code></li>
<li>For failing SharePoint CSOM calls: <code>CsomServiceException</code></li>
</ul>
</li>
</ul>
<p>All PnP Core exceptions inherit from <code>PnPException</code>, for service calls there's an extra base exception named <code>ServiceException</code> which enables you to filter out all service call related exceptions.</p>
<h2 id="catching-a-pnp-core-sdk-exception-and-getting-the-exception-details">Catching a PnP Core SDK exception and getting the exception details</h2>
<p>All PnP Core SDK specific exceptions inherit from <code>PnPException</code> making it easy for you to filter them out. Also each <code>PnPException</code> does have an <code>Error</code> property holding detailed exception information. As <code>PnPException</code> is an abstract base class you'd typically want to work with the actual exceptions like <code>ClientException</code>, <code>AuthenticationException</code>, <code>SharePointRestServiceException</code>, <code>MicrosoftGraphServiceException</code> and <code>CsomServiceException</code> as shown in below code snippets. The first snippet shows how to log the detailed exception information, when you call <code>ToString()</code> on the exception a stacktrace will be included, calling <code>ToString()</code> on an <code>Error</code> object will just get you the error details.</p>
<pre><code class="lang-csharp">try
{
    // Make service call    
}
// Catch all service exceptions
catch (ServiceException ex)
{
    // Option 1: Dump full error information to your log, including exception stacktrace
    Console.WriteLine(ex.ToString());

    // Option 2: Only handle SharePoint REST exceptions
    if (ex is SharePointRestServiceException)
    {
        // Let's get the detailed error information
        SharePointRestError error = ex.Error as SharePointRestError;

        // Write detailed error information to a log
        Console.WriteLine(error.ToString());
    }

    // Option 3: handle all service errors
    Console.WriteLine(ex.Error.ToString());
}
</code></pre>
<p>Having the detailed exception information sometimes is also needed to 'eat' expected exceptions as shown in this sample working with files:</p>
<pre><code class="lang-csharp">IFile image = null;
bool fileExists = false;
try
{
    image = await clientContext.Web.GetFileByServerRelativeUrlAsync(&quot;/sites/hrweb/siteassets/image1.png&quot;);
    fileExists = true;
}
catch(SharePointRestServiceException ex)
{
    var error = ex.Error as SharePointRestError;

    // Indicates the file did not exist
    if (error.HttpResponseCode == 404 &amp;&amp; error.ServerErrorCode == -2130575338)
    {
        Console.WriteLine(&quot;File does not exist...we're eating the exception and continue&quot;);
    }
    else 
    {
        throw
    }
}

if (fileExists)
{
    // Do something with the image
}
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>