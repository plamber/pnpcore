<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Interop with PnP Framework | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Interop with PnP Framework | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/basics-pnpframework.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="interop-with-pnp-framework">Interop with PnP Framework</h1>

<p>The PnP Core SDK is always used when PnP Framework is used as it's a dependency of PnP Framework, e.g. the Pages API implementation of PnP Core SDK is used in PnP Framework. When you're code is using PnP Framework you might also want to use additional PnP Core SDK features, or vice versa when you're using PnP Core SDK you might want to use SharePoint CSOM. Both options are discussed in this article.</p>
<h2 id="using-pnp-core-sdk-when-pnp-framework-was-already-configured">Using PnP Core SDK when PnP Framework was already configured</h2>
<p>In PnP Core SDK a PnPContext is used while in PnP Framework a CSOM context is used. When you have a CSOM context you can create a PnPContext using the <code>PnPCoreSDK.Instance.GetPnPContext()</code> methods.</p>
<pre><code class="lang-csharp">var authManager = new AuthenticationManager(&quot;&lt;Azure AD client id&gt;&quot;, &quot;joe@contoso.onmicrosoft.com&quot;, &quot;Pwd as SecureString&quot;);

using (var csomContext = authManager.GetContext(&quot;https://contoso.sharepoint.com&quot;))
{
    // Use CSOM to load the web title
    csomContext.Load(csomContext.Web, p =&gt; p.Title);
    csomContext.ExecuteQueryRetry();

    using (PnPContext pnpCoreContext = PnPCoreSdk.Instance.GetPnPContext(csomContext))
    {
        // Use PnP Core SDK (Microsoft Graph / SPO Rest) to load the web title
        var web = pnpCoreContext.Web.Get(p =&gt; p.Title);
    }
}
</code></pre>
<p>Above approach will trigger the creation of an <code>IPnPContextFactory</code> which will then be used to create the <code>PnPContext</code>. This <code>IPnPContextFactory</code> will be initialized using default settings, if you want to use a different configuration (e.g. because you're using another cloud environment or have need to use other non-default PnP Core settings) then you can specify the <code>IPnPContextFactory</code> while calling the <code>PnPCoreSDK.Instance.GetPnPContext()</code> methods.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Once you pass in your custom <code>IPnPContextFactory</code> by calling the <code>PnPCoreSDK.Instance.GetPnPContext()</code> methods then this <code>IPnPContextFactory</code> will also be used by all PnP Framework internal calls to <code>PnPCoreSDK.Instance.GetPnPContext()</code>.</p>
</div>
<pre><code class="lang-csharp">using (PnPContext pnpCoreContext = PnPCoreSdk.Instance.GetPnPContext(csomContext, pnpContextFactory))
{
    // Use PnP Core SDK (Microsoft Graph / SPO Rest) to load the web title
    var web = pnpCoreContext.Web.Get(p =&gt; p.Title);

    // After the first time passing in the IPnPContextFactory it will also be used by the implicit 
    // GetPnPContext calls from within PnP Framework
    // E.g. Calling the AddClientSidePage extension method will under the covers create a PnPContext 
    // using the passed IPnPContextFactory
    var page = csomContext.Web.AddClientSidePage(&quot;demo.aspx&quot;, true);
}
</code></pre>
<h2 id="using-pnp-framework-when-the-pnp-core-sdk-was-already-configured">Using PnP Framework when the PnP Core SDK was already configured</h2>
<p>If you already have a PnP Core SDK context and you want also use PnP Framework and/or SharePoint CSOM then you can create a CSOM ClientContext from your PnP Context via the <code>PnPCoreSDK.Instance.GetClientContext()</code> method.</p>
<pre><code class="lang-csharp">using (var pnpCoreContext = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // Use PnP Core SDK (Microsoft Graph / SPO Rest) to load the web title
    var web = pnpCoreContext.Web.Get(p =&gt; p.Title);

    using (ClientContext csomContext = PnPCoreSdk.Instance.GetClientContext(pnpCoreContext))
    {
        // Use CSOM to load the web title
        csomContext.Load(csomContext.Web, p =&gt; p.Title);
        csomContext.ExecuteQueryRetry();
    }    
}
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>