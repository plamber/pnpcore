<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Configuring the PnP Core SDK via settings | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Configuring the PnP Core SDK via settings | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/basics-settings.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="configuring-the-pnp-core-sdk-via-settings">Configuring the PnP Core SDK via settings</h1>

<p>The PnP Core SDK uses a default configuration and as such you're not required to provide specific settings. However, if you want to change the settings, then providing the custom settings via a settings service (e.g. settings file) is the way to go.</p>
<h2 id="sample-settings-file">Sample settings file</h2>
<p>Below snippet shows the settings which are used by the PnP Core SDK, you can simply include this snippet in your application settings file next to your custom settings.</p>
<pre><code class="lang-json">{
  &quot;PnPCore&quot;: {
    &quot;DisableTelemetry&quot;: &quot;false&quot;,
    &quot;Environment&quot;: &quot;Production&quot;,
    &quot;HttpRequests&quot;: {
      &quot;UserAgent&quot;: &quot;ISV|Contoso|ProductX&quot;,
      &quot;Timeout&quot;: &quot;100&quot;,
      &quot;SharePointRest&quot;: {
        &quot;UseRetryAfterHeader&quot;: &quot;false&quot;,
        &quot;MaxRetries&quot;: &quot;10&quot;,
        &quot;DelayInSeconds&quot;: &quot;3&quot;,
        &quot;UseIncrementalDelay&quot;: &quot;true&quot;,
        &quot;DefaultPageSize&quot;: 100
      },
      &quot;MicrosoftGraph&quot;: {
        &quot;UseRetryAfterHeader&quot;: &quot;true&quot;,
        &quot;MaxRetries&quot;: &quot;10&quot;,
        &quot;DelayInSeconds&quot;: &quot;3&quot;,
        &quot;UseIncrementalDelay&quot;: &quot;true&quot;
      }
    },
    &quot;PnPContext&quot;: {
      &quot;GraphFirst&quot;: &quot;true&quot;,
      &quot;GraphCanUseBeta&quot;: &quot;true&quot;,
      &quot;GraphAlwaysUseBeta&quot;: &quot;false&quot;
    },
    &quot;Credentials&quot;: {
      &quot;CredentialManagerAuthentication&quot;: {
        &quot;CredentialManagerName&quot;: &quot;mycreds&quot;
      }
    },
    &quot;Sites&quot;: {
      &quot;SiteToWorkWith&quot;: {
        &quot;SiteUrl&quot;: &quot;https://contoso.sharepoint.com/sites/pnp&quot;,
        &quot;AuthenticationProviderName&quot;: &quot;CredentialManagerAuthentication&quot;
      },
    }
  },

  // Not really library related, but since the library assumes logging is connected it's being shown here
  &quot;Logging&quot;: {
    &quot;LogLevel&quot;: {
      &quot;Default&quot;: &quot;Debug&quot;
    }
  }
}
</code></pre>
<h2 id="settings-overview">Settings overview</h2>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logging:LogLevel:Default</td>
<td>Information</td>
<td>Allows you to change log level. See the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-3.1#log-level">.Net Logging article</a> for more details. Common levels are Debug and Information.</td>
</tr>
<tr>
<td>PnPCore:PnPContext:GraphFirst</td>
<td>true</td>
<td>If for a given request the library can choose between a SharePoint REST or a Microsoft Graph call then it will favor the Microsoft Graph call. Settings this to false will prefer SharePoint REST for all SharePoint related API calls.</td>
</tr>
<tr>
<td>PnPCore:PnPContext:GraphCanUseBeta</td>
<td>true</td>
<td>When you ask for data that can only be provided via the Microsoft Graph beta API the PnP Core SDK will use the beta endpoint for that specific request. All other requests will still use the v1.0 endpoint. If you set this to false, then any request that requires Microsoft Graph beta will not provide any result.</td>
</tr>
<tr>
<td>PnPCore:PnPContext:GraphAlwaysUsesBeta</td>
<td>false</td>
<td>The library by default uses the production v1.0 Microsoft Graph API. Use this setting to default it to the beta Microsoft Graph API.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:UserAgent</td>
<td>NONISV|SharePointPnP<br>|PnPCoreSDK</td>
<td>Value set as user agent when the request is sent to Microsoft 365.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:Timeout</td>
<td>100</td>
<td>Timeout in seconds for HTTP requests. Set higher if you need to for example download large files. Setting to -1 will result in an infinite timeout.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:RateLimiterMinimumCapacityLeft</td>
<td>0</td>
<td>Setting this value between 1 and 20 will result in request delaying when RateLimit headers indicate the application is about to get throttled</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:SharePointRest:UseRetryAfterHeader</td>
<td>false</td>
<td>Use retry-after http header when calculating the wait time in seconds for SharePoint Rest request retry.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:SharePointRest:MaxRetries</td>
<td>10</td>
<td>Maximum number of retries before retrying a SharePoint Rest request throws an exception.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:SharePointRest:DelayInSeconds</td>
<td>3</td>
<td>Delay in seconds between SharePoint Rest request retries.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:SharePointRest:IncrementalDelay</td>
<td>true</td>
<td>Delays get incrementally longer with each retry.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:SharePointRest:DefaultPageSize</td>
<td>100</td>
<td>Page size using when paging is automatically applied during data querying via the PnP Core SDK LINQ support.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:MicrosoftGraph:UseRetryAfterHeader</td>
<td>true</td>
<td>Use retry-after http header when calculating the wait time in seconds for Microsoft Graph request retry.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:MicrosoftGraph:MaxRetries</td>
<td>10</td>
<td>Maximum number of retries before retrying a Microsoft Graph request throws an exception.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:MicrosoftGraph:DelayInSeconds</td>
<td>3</td>
<td>Delay in seconds between Microsoft Graph request retries.</td>
</tr>
<tr>
<td>PnPCore:HttpRequests:MicrosoftGraph:IncrementalDelay</td>
<td>true</td>
<td>Delays get incrementally longer with each retry.</td>
</tr>
<tr>
<td>PnPCore:Environment</td>
<td>Production</td>
<td>Use this setting if you are using a cloud environment <strong>different</strong> from the standard production cloud: possible values are <code>Production</code>, <code>PreProduction</code>, <code>USGovernment</code> (a.k.a GCC), <code>USGovernmentHigh</code> (a.k.a GCC High), <code>USGovernmentDoD</code> (a.k.a DoD), <code>China</code>, <code>Germany</code> and <code>Custom</code>. <strong>Important:</strong> use the correct casing when using these values, when set to <code>Custom</code> also specify <code>MicrosoftGraphAuthority</code> and <code>AzureADLoginAuthority</code>.</td>
</tr>
<tr>
<td>PnPCore:MicrosoftGraphAuthority</td>
<td>null</td>
<td>If you've set <code>PnPCore:Environment</code> to <code>Custom</code> then you're required to specify the Microsoft Graph authority to use (e.g. graph.microsoft.com).</td>
</tr>
<tr>
<td>PnPCore:AzureADLoginAuthority</td>
<td>null</td>
<td>If you've set <code>PnPCore:Environment</code> to <code>Custom</code> then you're required to specify the Azure AD login authority to use (e.g. login.microsoftonline.com).</td>
</tr>
<tr>
<td>PnPCore:DisableTelemetry</td>
<td>false</td>
<td>Allows to turn off telemetry being sent. Telemetry is used to improve this open source library and it's recommended to keep it on, but you can disable it, if required.</td>
</tr>
<tr>
<td>PnPCore:Credentials</td>
<td></td>
<td>This section defines the settings for the Authentication Providers and it will be updated in the near future.</td>
</tr>
<tr>
<td>PnPCore:Sites</td>
<td></td>
<td>This section defines the site collections to consume using the PnP Core SDK. Every single item of the array has a name, which can then be used with the PnPContextFactory to retrieve an instance of PnPContext for that specific site, a <em>SiteUrl</em> and the <em>AuthenticationProviderName</em> that maps to the corresponding Authentication Provider to use for accessing the target site.</td>
</tr>
</tbody>
</table>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>