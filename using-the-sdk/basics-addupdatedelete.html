<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Adding, updating or deleting data from Microsoft 365 | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Adding, updating or deleting data from Microsoft 365 | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/basics-addupdatedelete.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="adding-updating-or-deleting-data-from-microsoft-365">Adding, updating or deleting data from Microsoft 365</h1>

<p>Adding, updating or deleting data (e.g. a SharePoint list item or a Teams channel message) is usually needed when you write applications using the PnP Core SDK and in this article you'll get a brief overview on how to add, update or delete data.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for adding, updating and deleting data
}
</code></pre>
<h2 id="adding-data">Adding data</h2>
<p>Adding of data is usually done via an Add method on the collection to which you want to add data, so if you want to add an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html">IListItem</a> you would use one of the Add methods (e.g. <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItemCollection.html#collapsible-PnP_Core_Model_SharePoint_IListItemCollection_AddAsync_Dictionary_System_String_System_Object__">AddAsync</a>) on the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItemCollection.html">IListItemCollection</a> collection. Given that each model (List Item, File, TeamChannel,..) requires different input for doing an add you'll see different add method signatures.</p>
<pre><code class="lang-csharp">Dictionary&lt;string, object&gt; item = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
    { &quot;Field A&quot;, 25 }
};

// Add the item
var addedItem = await myList.Items.AddAsync(item);
</code></pre>
<p>Another add example is adding (= uploading) a file to a document library:</p>
<pre><code class="lang-csharp">// Get a reference to a folder
IFolder siteAssetsFolder = await context.Web.Folders.Where(f =&gt; f.Name == &quot;SiteAssets&quot;).FirstOrDefaultAsync();

// Upload a file by adding it to the folder's files collection
IFile addedFile = await siteAssetsFolder.Files.AddAsync(&quot;test.docx&quot;, 
                  System.IO.File.OpenRead($&quot;.{Path.DirectorySeparatorChar}TestFilesFolder{Path.DirectorySeparatorChar}test.docx&quot;));
</code></pre>
<h2 id="updating-data">Updating data</h2>
<p>To update data you first need to get the data to update, see <a href="basics-getdata.html">Get data</a> to learn more on getting data. Once you've data (e.g. you did get a list) you can update the list by changing one of it's properties and then call one of the update methods (e.g. UpdateAsync). You can perform multiple updates to the model and only when you're done with updating the properties you need to call one of the update methods, the PnP Core SDK will keep track of the changes and will only use the actually changed properties in the update request.</p>
<pre><code class="lang-csharp">// Get the list to update
var myList = await context.Web.Lists.GetByTitleAsync(&quot;List to update&quot;);

// Update a list property
myList.Description = &quot;PnP Rocks!&quot;;

// Update another list property
myList.EnableVersioning = true;

// Send update to the server
await myList.UpdateAsync();
</code></pre>
<h2 id="deleting-data">Deleting data</h2>
<p>To delete data you do have two options, the first one is deleting the loaded model: like with updating you first need to have the model instance to delete available, see <a href="basics-getdata.html">Get data</a> to learn more on getting data. Once you have the model to delete available (e.g. a list item) you can use one of the delete methods to perform the delete. Below example uses the DeleteBatchAsync method to delete all items of a list with a single network request.</p>
<pre><code class="lang-csharp">// Assume the fields where not yet loaded, so loading them with the list
var myList = await context.Web.Lists.GetByTitleAsync(&quot;My List&quot;, 
                                                    p =&gt; p.Title, p =&gt; p.Items, 
                                                    p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                        p =&gt; p.FieldTypeKind,
                                                        p =&gt; p.TypeAsString, 
                                                        p =&gt; p.Title));
// Iterate over the retrieved list items
foreach (var listItem in myList.Items.AsRequested())
{
    // Delete all the items in &quot;My List&quot; by adding them to a batch
    await listItem.DeleteBatchAsync();
}

// Execute the batch
await context.ExecuteAsync();
</code></pre>
<p>The second approach does not require you to upfront load the item to delete: model collections that support this type of delete either have DeleteById methods which you simply call and provide the unique id of the item to delete. Below sample shows how to delete a list using this approach.</p>
<pre><code class="lang-csharp">// Delete the list with the given id
await context.Web.Lists.DeleteByIdAsync(new Guid(&quot;E623E1A0-6786-498B-99D2-EE6355851CDB&quot;));

// Add the delete of the list with given if to the current batch
await context.Web.Lists.DeleteByIdBatchAsync(new Guid(&quot;E623E1A0-6786-498B-99D2-EE6355851CDB&quot;));
// Execute the current batch
await context.ExecuteAsync();
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>