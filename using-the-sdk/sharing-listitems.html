<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Sharing list items | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Sharing list items | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/sharing-listitems.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="sharing-list-items">Sharing list items</h1>

<p>List items are a key part of SharePoint and when you want to share a list item with other users you can use the PnP Core SDK Sharing support.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for working with lists
}
</code></pre>
<h2 id="scoping-the-share">Scoping the &quot;share&quot;</h2>
<p>When you share content you often just want to share what's really needed, oversharing content is never a good idea. When using the share features in PnP Core SDK you can either share:</p>
<ul>
<li>A single list item (<code>IListItem</code>)</li>
<li>A single file (<code>IFile</code>) (see <a href="sharing-intro.html">here</a> for more details)</li>
<li>A single folder and all the contents inside that folder (<code>IFolder</code>). Note that to share the contents of a complete library you can use the <code>IList.RootFolder</code> property as sharing target (see <a href="sharing-intro.html">here</a> for more details)</li>
</ul>
<p>After selecting what to share the next step is providing information about with whom you're sharing and how the sharing will be configured. To what extend you can configure all of this depends on the external sharing settings configured for your tenant. Navigate to your <strong>SharePoint admin center</strong>, click <strong>Policies</strong> in the left navigation and select <strong>Sharing</strong> to see the tenant sharing configuration.</p>
<p>Next to the sharing configuration and tenant level there are also sharing settings at site collection level as certain site collections can be configured with more restrictive sharing policies versus the tenant. If you're using the PnP Core SDK sharing API and you're running into issues then ensure the site collection sharing settings are set correctly. Navigate to your <strong>SharePoint admin center</strong>, click <strong>Sites</strong> in the left navigation and select <strong>Active sites</strong>. In the list of site collections find the one you want to share and verify, select it and the click on the <strong>...</strong> and pick <strong>Sharing</strong> to open the site collection sharing settings.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You can also programmatically verify and alter site collection sharing settings via the <a href="https://pnp.github.io/pnpcore/using-the-sdk/admin-sharepoint-sites.html#getting-and-setting-site-collection-properties">PnP Core SDK Admin component</a>.</p>
</div>
<h2 id="sharing-list-items-with-your-organization">Sharing list items with your organization</h2>
<p>To share list items within your tenant (your organization) you need to use one of the <code>CreateOrganizationalSharingLink</code> methods in combination with a configured <code>OrganizationalLinkOptions</code> instance. The only property to set here is the <code>Type</code> of share: do you want to enable people in your organization to view the shared content or also edit the list item?</p>
<pre><code class="lang-csharp">var myList = context.Web.Lists.GetByTitle(&quot;My List&quot;, 
                                          p =&gt; p.Title, p =&gt; p.Items, 
                                          p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                                        p =&gt; p.FieldTypeKind, 
                                                                        p =&gt; p.TypeAsString, 
                                                                        p =&gt; p.Title));
// Get the item with title &quot;Item1&quot;
var listItem = myList.Items.AsRequested().FirstOrDefault(p =&gt; p.Title == &quot;Item1&quot;);

var shareLinkRequestOptions = new OrganizationalLinkOptions()
{
    Type = ShareType.Edit
};

// Grant everyone in the organization edit permissions on the list item                
var share = await listItem.CreateOrganizationalSharingLinkAsync(shareLinkRequestOptions);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The supported share types for a list item are <code>View</code>, <code>Edit</code> and <code>Embed</code></p>
</div>
<h2 id="share-list-items-with-certain-users">Share list items with certain users</h2>
<p>If you want to selectively share a list item with one or more users you can use one of the <code>CreateUserSharingLink</code> methods in combination with a configured <code>UserLinkOptions</code> instance. Key properties to set are the <code>Recipients</code> (people you're sharing to) and <code>Type</code> of share. Below example shows this:</p>
<pre><code class="lang-csharp">var myList = context.Web.Lists.GetByTitle(&quot;My List&quot;, 
                                          p =&gt; p.Title, p =&gt; p.Items, 
                                          p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                                        p =&gt; p.FieldTypeKind, 
                                                                        p =&gt; p.TypeAsString, 
                                                                        p =&gt; p.Title));
// Get the item with title &quot;Item1&quot;
var listItem = myList.Items.AsRequested().FirstOrDefault(p =&gt; p.Title == &quot;Item1&quot;);

// List of users to share the file/folder with
var recipients = new List&lt;IDriveRecipient&gt;()
{
    new DriveRecipient
    {
        Email = &quot;linda@contoso.onmicrosoft.com&quot;
    },
    new DriveRecipient
    {
        Email = &quot;joe@contoso.onmicrosoft.com&quot;
    }
};

var shareLinkRequestOptions = new UserLinkOptions()
{
    // Selected users can see the list item online
    Type = ShareType.View,
    Recipients = recipients
};

var share = await listItem.CreateUserSharingLinkAsync(shareLinkRequestOptions);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The supported share types for a list item are <code>View</code>, <code>Edit</code> and <code>Embed</code></p>
</div>
<h2 id="share-list-items-with-everyone-anonymous-sharing">Share list items with everyone (anonymous sharing)</h2>
<p>If your tenant and site settings allow it you can also share list items anonymously so that everyone having the link can access the content. Doing so requires using one of the <code>CreateAnonymousSharingLink</code> methods together with a configured <code>AnonymousLinkOptions</code> instance. Key properties to set are the <code>Type</code> of share, a <code>Password</code> for consuming the sharing link and <code>ExpirationDateTime</code> defining how long the anonymous share will stay valid. Below example shows this:</p>
<pre><code class="lang-csharp">var myList = context.Web.Lists.GetByTitle(&quot;My List&quot;, 
                                          p =&gt; p.Title, p =&gt; p.Items, 
                                          p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                                        p =&gt; p.FieldTypeKind, 
                                                                        p =&gt; p.TypeAsString, 
                                                                        p =&gt; p.Title));
// Get the item with title &quot;Item1&quot;
var listItem = myList.Items.AsRequested().FirstOrDefault(p =&gt; p.Title == &quot;Item1&quot;);

var shareLinkRequestOptions = new AnonymousLinkOptions()
{
    Type = ShareType.View,
    Password = &quot;PnP Rocks!&quot;,
    ExpirationDateTime = DateTime.Now.AddDays(5)
};                

var share = await listItem.CreateAnonymousSharingLinkAsync(shareLinkRequestOptions);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The supported share types for a list item are <code>View</code>, <code>Edit</code> and <code>Embed</code></p>
</div>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>