<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Site and List fields | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Site and List fields | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/fields-intro.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="site-and-list-fields">Site and List fields</h1>

<p>Each SharePoint site uses <a href="https://support.microsoft.com/en-us/office/list-and-library-column-types-and-options-0d8ddb7b-7dc7-414d-a283-ee9dca891df7">fields</a>, a site comes prepopulated with a set of site fields and a set of lists and libraries that use these fields. You can also create your own fields, either being a site field or list field. A site field can be reused across multiple lists in the site collection, whereas a list field only can be used in the list for which the field was created. Creating site and list fields is from a developer point of view quite similar so both options are discussed together in this article.</p>
<p>The PnP Core SDK does support the common fields SharePoint offers:</p>
<ul>
<li>Text</li>
<li>Multiline text</li>
<li>Number</li>
<li>Boolean</li>
<li>DateTime</li>
<li>Currency</li>
<li>Calculated</li>
<li>Choice</li>
<li>Multi choice</li>
<li>Url</li>
<li>User</li>
<li>Multi user</li>
<li>Lookup</li>
<li>Multi lookup</li>
<li>Taxonomy</li>
<li>Multi taxonomy</li>
<li>Location (by GA timeframe)</li>
</ul>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for working with fields
}
</code></pre>
<h2 id="getting-the-current-site-and-list-fields">Getting the current site and list fields</h2>
<p>Getting the currently defined fields on a web can be done by loading the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_Fields">Fields</a> property as that will return an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldCollection.html">IFieldCollection</a>:</p>
<pre><code class="lang-csharp">//  Get site fields
var web = await context.Web.GetAsync(l =&gt; l.Fields);

foreach(var field in web.Fields.AsRequested())
{
    // do something with the field
}
</code></pre>
<p>For a list similar logic applies, you can load the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_Fields">Fields</a> property on an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html">IList</a>:</p>
<pre><code class="lang-csharp">//  Get documents library with fields loaded
var documents = await context.Web.Lists.GetByTitleAsync(&quot;Documents&quot;, l =&gt; l.Fields);

foreach(var field in documents.Fields.AsRequested())
{
    // do something with the field
}
</code></pre>
<p>Above samples do load all the default Field properties, but what if you are only interested in a few properties or the property you need is not loaded by default? For that purpose the best approach is using the QueryProperties method as that allows for getting the needed field data in a single roundtrip to the server. Below code snippets show this method in action for loading specific field properties</p>
<pre><code class="lang-csharp">//  Get site fields
var web = await context.Web.GetAsync(l =&gt; l.Fields.QueryProperties(l =&gt; l.Id, l =&gt; l.InternalName, l =&gt; l.FieldTypeKind));

foreach(var field in web.Fields.AsRequested())
{
    // do something with the field
}
</code></pre>
<pre><code class="lang-csharp">//  Get documents library with fields loaded
var documents = await context.Web.Lists.GetByTitleAsync(&quot;Documents&quot;, l =&gt; l.Fields.QueryProperties(l =&gt; l.Id, l =&gt; l.InternalName, l =&gt; l.FieldTypeKind));

foreach(var field in documents.Fields.AsRequested())
{
    // do something with the field
}
</code></pre>
<h2 id="adding-site-and-list-fields">Adding site and list fields</h2>
<p>Adding fields is described in the <a href="fields-add.html">Adding fields</a> article.</p>
<h2 id="updating-site-and-list-fields">Updating site and list fields</h2>
<p>To update a field you simply update it's value and call the Update or UpdateAsync methods:</p>
<pre><code class="lang-csharp">// Find a field with a given id
Guid titleFieldId = new Guid(&quot;fa564e0f-0c70-4ab9-b863-0177e6ddd247&quot;);
IField field = await context.Web.Fields.Where(f =&gt; f.Id == titleFieldId).FirstOrDefaultAsync();

if (field != null)
{
    field.Hidden = true;
    await field.UpdateAsync();
}
</code></pre>
<p>If you want to update a site field and push the field updates to the lists using that field then you'd need to use one of the <code>UpdateAndPushChanges</code> methods:</p>
<pre><code class="lang-csharp">// Find a field with a given id
Guid titleFieldId = new Guid(&quot;fa564e0f-0c70-4ab9-b863-0177e6ddd247&quot;);
IField field = await context.Web.Fields.Where(f =&gt; f.Id == titleFieldId).FirstOrDefaultAsync();

if (field != null)
{
    field.Hidden = true;
    await field.UpdateAndPushChangesAsync();
}
</code></pre>
<h2 id="deleting-site-and-list-fields">Deleting site and list fields</h2>
<p>Deleting a field can be done using the Delete or DeleteAsync methods:</p>
<pre><code class="lang-csharp">// Find a field with a given id
Guid titleFieldId = new Guid(&quot;fa564e0f-0c70-4ab9-b863-0177e6ddd247&quot;);
IField field = await context.Web.Fields.Where(f =&gt; f.Id == titleFieldId).FirstOrDefaultAsync();

if (field != null)
{
    await field.DeleteAsync();
}
</code></pre>
<h2 id="control-field-visibility-on-list-display-edit-and-new-forms">Control field visibility on list display, edit and new forms</h2>
<p>By default all fields on a list, unless marked as hidden, will appear on the list forms (display, edit and new). If you want to change the visibility of a field on one of these forms then you can use the <code>SetShowInDisplayForm</code>,  <code>SetShowInEditForm</code> or <code>SetShowInNewForm</code> methods.</p>
<pre><code class="lang-csharp">// Find a field with a given id on a web or list
Guid titleFieldId = new Guid(&quot;fa564e0f-0c70-4ab9-b863-0177e6ddd247&quot;);
IField field = await context.Web.Fields.Where(f =&gt; f.Id == titleFieldId).FirstOrDefaultAsync();

if (field != null)
{
    // Hide field in new display form
    await field.SetShowInDisplayFormAsync(false);

    // Hide field in new edit form
    await field.SetShowInEditFormAsync(false);

    // Hide field in new new form
    await field.SetShowInNewFormAsync(false);
}
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>