<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Working with pages: an introduction | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Working with pages: an introduction | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/pages-intro.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="working-with-pages-an-introduction">Working with pages: an introduction</h1>

<p>Each SharePoint site uses pages, being <a href="https://support.microsoft.com/en-us/office/pages-in-sharepoint-3833b917-a39d-43f9-85ff-f17949fc1034?ui=en-US&amp;rs=en-US&amp;ad=US">modern pages</a> or classic pages like wiki, webpart or publishing pages. PnP Core SDK does not support editing those classic pages, but there's extensive support for modern pages. In this article you'll learn how to load pages, how to create, update, configure and delete them.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for working with pages
}
</code></pre>
<h2 id="loading-an-existing-page">Loading an existing page</h2>
<p>Quite often you need to update an previously created page, so you'll first need to load the existing page. Loading existing pages can be done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_GetPagesAsync_System_String_">GetPagesAsync method</a>.</p>
<h3 id="load-all-the-pages-on-a-site">Load all the pages on a site</h3>
<pre><code class="lang-csharp">var pages = await context.Web.GetPagesAsync();
</code></pre>
<h3 id="load-pages-filtered-on-page-name">Load pages filtered on page name</h3>
<p>Below call will get all the pages on the site for which the name starts with <code>PageA</code>.</p>
<pre><code class="lang-csharp">var pages = await context.Web.GetPagesAsync(&quot;PageA&quot;);
</code></pre>
<p>If you want to only find one page then provide the actual page name with the .aspx extension:</p>
<pre><code class="lang-csharp">var pages = await context.Web.GetPagesAsync(&quot;PageABC.aspx&quot;);
var pageABC = pages.First();
</code></pre>
<h3 id="load-pages-in-a-given-folder">Load pages in a given folder</h3>
<p>Modern pages can be organized in folders, if you want to load a page from a given folder (the previous samples loaded pages across all folders) then you need to prepend the folder path to the page when searching for it:</p>
<pre><code class="lang-csharp">string pageName = &quot;folder1/PageInFolder.aspx&quot;;
var pages = await context.Web.GetPagesAsync(pageName);
var pageInFolder = pages.First();
</code></pre>
<p>If the page lives in a nested folder you can provide the nest path:</p>
<pre><code class="lang-csharp">string pageName = &quot;folder1/folder2/folder3/PageInFolder3.aspx&quot;;
var pages = await context.Web.GetPagesAsync(pageName);
var pageInFolder3 = pages.First();
</code></pre>
<p>Note that when a page was loaded from a folder the <code>Folder</code> property of the retuned page will contain the folder:</p>
<pre><code class="lang-csharp">string pageName = &quot;folder1/folder2/folder3/PageInFolder3.aspx&quot;;
var pages = await context.Web.GetPagesAsync(pageName);
var pageInFolder3 = pages.First();

// Outputs folder1/folder2/folder3
Console.WriteLine(pagesInFolder3.Folder);
</code></pre>
<h2 id="adding-a-new-page">Adding a new page</h2>
<p>Adding a new page always consists out of two steps: you first create a new page via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_NewPageAsync_PnP_Core_Model_SharePoint_PageLayoutType_">NewPageAsync method</a> and persist the created page via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#collapsible-PnP_Core_Model_SharePoint_IPage_SaveAsync_System_String_">SaveAsync method</a>.</p>
<pre><code class="lang-csharp">// Create the page
var newPage = await context.Web.NewPageAsync();

// configure the page

// Save the page
await newPage.SaveAsync(&quot;MyPage.aspx&quot;);
</code></pre>
<p>When you create a new page the default will be an <strong>Article</strong> page, but you can also create other types of pages. The pages API supports these common types of pages:</p>
<ul>
<li><strong>Article page</strong>: this is typical page you'd create using the SharePoint user interface</li>
<li><strong>Repost page</strong>: this page is a re-posting of existing content where existing content can be a link to a resource on the internet or an other page in your SharePoint environment</li>
<li><strong>Home page</strong>: this is a page created with as purpose to become the home page of the site, this page has no page header by design and has no page commenting</li>
<li><strong>Spaces page</strong>: <a href="https://www.exploresharepointspaces.com/">SharePoint Spaces</a> pages can host mixed reality content</li>
</ul>
<p>To pick another page type during creation specify the type as input of the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_NewPageAsync_PnP_Core_Model_SharePoint_PageLayoutType_">NewPageAsync method</a>:</p>
<pre><code class="lang-csharp">// Create the page
var newPage = await context.Web.NewPageAsync(PageLayoutType.RepostPage);
</code></pre>
<h3 id="adding-a-page-in-a-given-folder">Adding a page in a given folder</h3>
<p>When you want to create a page in a folder you need to prepend the folder to the page name on save:</p>
<pre><code class="lang-csharp">// Create the page
var newPage = await context.Web.NewPageAsync();

// configure the page

// Save the page
await newPage.SaveAsync(&quot;folder1/folder2/MyPageInFolder2.aspx&quot;);
</code></pre>
<h3 id="saving-a-page-as-a-template">Saving a page as a template</h3>
<p>A page can also be saved as a template, when users of the site want to create a new page they can base themselves of a template page. To save a page as a template you instead of the <code>SaveAsync()</code> use the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#collapsible-PnP_Core_Model_SharePoint_IPage_SaveAsTemplateAsync_System_String_">SaveAsTemplateAsync method</a>:</p>
<pre><code class="lang-csharp">// Create the page
var newPage = await context.Web.NewPageAsync();

// configure the page

// Save the page
await newPage.SaveAsTemplateAsync(&quot;MyTemplatePage.aspx&quot;);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>You do not need to specify the templates folder, the page API will ensure the templates folder does exist and automatically use it.</p>
</div>
<h2 id="configuring-a-page">Configuring a page</h2>
<p>Whenever you've created a new page or loaded an existing page, you often need to also configure the page by adding content to it. In this chapter you'll learn how to do so.</p>
<h3 id="setting-up-your-page-layout">Setting up your page layout</h3>
<p>A modern page exists out of one or more sections of a given type:</p>
<ul>
<li>One column section: section contain one column</li>
<li>One column fullwidth section: section containing one column that's covering the full width of the page (you can only have one of these per page)</li>
<li>Two column section: section with two equally sized columns</li>
<li>Two column left section: section with the left column 2/3 in size and the right one 1/3</li>
<li>Two column right section: section with the left column 1/3 in size and the right one 2/3</li>
<li>Three column section: section with three equally sized columms</li>
</ul>
<p>The above sections, except one column fullwidth, are also available in a variant that includes a page wide vertical column on the right side. You can only use one &quot;vertical column&quot; section on a page and it's mutually exclusive with the one column fullwidth section. Adding sections is done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#collapsible-PnP_Core_Model_SharePoint_IPage_AddSection_PnP_Core_Model_SharePoint_CanvasSectionTemplate_System_Single_">AddSection method</a>:</p>
<pre><code class="lang-csharp">// Create the page
var page = await context.Web.NewPageAsync();

// adding sections to the page
page.AddSection(CanvasSectionTemplate.OneColumnFullWidth, 1);
page.AddSection(CanvasSectionTemplate.OneColumn, 2);
page.AddSection(CanvasSectionTemplate.TwoColumn, 3);
page.AddSection(CanvasSectionTemplate.TwoColumnLeft , 4);
page.AddSection(CanvasSectionTemplate.TwoColumnRight, 5);
page.AddSection(CanvasSectionTemplate.ThreeColumn, 6);

// Save the page
await page.SaveAsync(&quot;MyPage.aspx&quot;);
</code></pre>
<p>You can also control the emphasis (background color) of the section and vertical column via specifying the needed emphasis in the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#collapsible-PnP_Core_Model_SharePoint_IPage_AddSection_PnP_Core_Model_SharePoint_CanvasSectionTemplate_System_Single_PnP_Core_Model_SharePoint_VariantThemeType_PnP_Core_Model_SharePoint_VariantThemeType_">AddSection method</a>:</p>
<pre><code class="lang-csharp">page.AddSection(CanvasSectionTemplate.TwoColumnVerticalSection, 1, VariantThemeType.Neutral, VariantThemeType.Strong);
</code></pre>
<h3 id="configuring-page-sections">Configuring page sections</h3>
<p>Adding a section to a page gets you a default, non-collapsible, section. If you want your section to be collapsible then simply set the <code>Collapsible</code> property to true and optionally configure the additional settings for collapsible sections:</p>
<pre><code class="lang-csharp">page.AddSection(CanvasSectionTemplate.TwoColumn, 1, VariantThemeType.Soft);
page.Sections[0].Collapsible = true;
page.Sections[0].DisplayName = &quot;My collapsible section&quot;;
page.Sections[0].IsExpanded = false;
page.Sections[0].ShowDividerLine = false;
page.Sections[0].IconAlignment = IconAlignment.Right;
</code></pre>
<h3 id="adding-controls-to-the-page">Adding controls to the page</h3>
<p>A control is either a piece of text or a web part and can be added in one of the section columns. Below sample shows how to add the text part to an existing section column. It boils down to these two steps:</p>
<ul>
<li>Creating a text part via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_NewTextPart_System_String_">NewTextPart method</a></li>
<li>Adding the text part into a previously created section column via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_AddControl_PnP_Core_Model_SharePoint_ICanvasControl_PnP_Core_Model_SharePoint_ICanvasColumn_">AddControl method</a></li>
</ul>
<pre><code class="lang-csharp">// Create the page
var page = await context.Web.NewPageAsync();

// adding sections to the page
page.AddSection(CanvasSectionTemplate.OneColumn, 1);

// Adding text control to the first section, first column
page.AddControl(page.NewTextPart(&quot;PnP Rocks!&quot;), page.Sections[0].Columns[0]);

// Save the page
await page.SaveAsync(&quot;MyPage.aspx&quot;);
</code></pre>
<h3 id="adding-web-parts-to-the-page">Adding web parts to the page</h3>
<p>Adding web parts is quite similar to adding text parts, but there's more work needed to prep a web part before it can be added. Before you can add a web part you need to get a 'blueprint' of the web part to add. This needs to be done via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_AvailablePageComponentsAsync_System_String_">AvailablePageComponentsAsync method</a>. Once you've the list of possible web parts to add you need to pick the one you need. If you're adding an out of the box web part then using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_DefaultWebPartToWebPartId_PnP_Core_Model_SharePoint_DefaultWebPart_">DefaultWebPartToWebPartId method</a> to map a readable name into a web part id works best. The final step is using the 'blueprint' with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_NewWebPart_PnP_Core_Model_SharePoint_IPageComponent_">NewWebPart method</a> to create a web part instance that can be added. Below sample shows all these steps:</p>
<pre><code class="lang-csharp">// Create the page
var page = await context.Web.NewPageAsync();

// adding sections to the page
page.AddSection(CanvasSectionTemplate.OneColumn, 1);

// get the web part 'blueprint'
var availableComponents = await page.AvailablePageComponentsAsync();
var imageWebPartComponent = availableComponents.FirstOrDefault(p =&gt; p.Id == page.DefaultWebPartToWebPartId(DefaultWebPart.Image));

// add the web part to the first column of the first section
page.AddControl(page.NewWebPart(imageWebPartComponent), page.Sections[0].Columns[0]);

// Save the page
await page.SaveAsync(&quot;MyPage.aspx&quot;);
</code></pre>
<h3 id="updating-the-page-author-editor-created-and-modified-system-properties">Updating the page Author, Editor, Created and Modified system properties</h3>
<p>A common request is to change the list item <code>Author</code>, <code>Editor</code>, <code>Created</code> and <code>Modified</code> system properties of a page, which is allowed via the <code>UpdateOverWriteVersion</code> methods.</p>
<div class="NOTE">
<h5>Note</h5>
<p>The Azure AD application you're using must have the <code>Sites.FullControl.All</code> permission to make updating the <code>Author</code>, <code>Editor</code>, <code>Created</code> and <code>Modified</code> system properties work.</p>
</div>
<pre><code class="lang-csharp">// Load the page you want to update
var pages = await context.Web.GetPagesAsync(&quot;mypage.aspx&quot;);
var myPage = pages.AsEnumerable().First();

// Load the page file with it's associated list item
var pageFile = await myPage.GetPageFileAsync(p =&gt; p.ListItemAllFields);

// Load the Author and Editor fields                
var author = myPage.PagesLibrary.Fields.AsRequested().FirstOrDefault(p =&gt; p.InternalName == &quot;Author&quot;);
var editor = myPage.PagesLibrary.Fields.AsRequested().FirstOrDefault(p =&gt; p.InternalName == &quot;Editor&quot;);

// Load the user to set as Author/Editor
var currentUser = await context.Web.GetCurrentUserAsync();
// Define the new date for Created/Modified
var newDate = new DateTime(2020, 10, 20);

// Update the properties
pageFile.ListItemAllFields[&quot;Author&quot;] = author.NewFieldUserValue(currentUser);
pageFile.ListItemAllFields[&quot;Editor&quot;] = editor.NewFieldUserValue(currentUser);
pageFile.ListItemAllFields[&quot;Created&quot;] = newDate;
pageFile.ListItemAllFields[&quot;Modified&quot;] = newDate;

// Persist the changes
await pageFile.ListItemAllFields.UpdateOverwriteVersionAsync();
</code></pre>
<h2 id="deleting-a-page">Deleting a page</h2>
<p>You can delete pages via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IPage.html#PnP_Core_Model_SharePoint_IPage_DeleteAsync">DeleteAsync method</a>:</p>
<pre><code class="lang-csharp">await page.DeleteAsync();
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>