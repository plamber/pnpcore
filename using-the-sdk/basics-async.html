<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Asynchronous versus synchronous | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Asynchronous versus synchronous | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/basics-async.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="asynchronous-versus-synchronous">Asynchronous versus synchronous</h1>

<p>Loading data (e.g. a SharePoint list or a Teams channel), updating, adding or deleting...all of these operations can be done either asynchronously (=async) or synchronously (=sync). In this chapter we explain the pro's and con's of each approach and provide some best practices.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext
}
</code></pre>
<h2 id="async-or-sync">Async or sync?</h2>
<p>Let's start with two code snippets which both result in a list item being loaded. The first snippet shows a sync way of loading a list via it's title followed by getting the item with id 1 from that list:</p>
<pre><code class="lang-csharp">using (var context = pnpContextFactory.Create(&quot;SiteToWorkWith&quot;))
{
    IItem item = context.Web.Lists.GetByTitle(&quot;Site Pages&quot;).Items.GetById(1);
}
</code></pre>
<p>In the second example we do the same but then async:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    IList list = await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;);
    IItem item = await list.Items.GetByIdAsync(1);
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Both approaches use 2 queries, there's no difference between async and sync when it comes to query efficiency.</p>
</div>
<p>Both approaches are comparable from a coding point of view: the difference is in the method names and the <code>await</code> keyword. You might also notice that for the sync approach the code is more fluent as there's no need for <code>await</code> statements, but a similar thing can be done with async via using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.QueryModel.BaseDataModelExtensions.html#collapsible-PnP_Core_QueryModel_BaseDataModelExtensions_AndThen__2_Task___0__Func___0_Task___1___">AndThen</a> method to chain async method calls or via nesting each async call with it's corresponding <code>await</code> keyword:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // Option A: Using AndThen() to chain async method calls
    IItem item = await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;).AndThen(p =&gt; p.Items.GetByIdAsync(1));

    // Option B: using multiple awaits
    IItem item = await (await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;)).Items.GetByIdAsync(1);
}
</code></pre>
<p>In general the recommendation is to use the async methods because:</p>
<ul>
<li>They result in better performing code</li>
<li>Improved application responsiveness (the UI thread is not blocked when a data retrieval is ongoing)</li>
<li>Prevents deadlocks when using the PnP Core SDK from WPF apps and <a href="https://dotnet.microsoft.com/apps/aspnet/web-apps/blazor">Blazor</a></li>
</ul>
<p>Internally in the PnP Core SDK everything always happens async, the sync methods you see are wrappers over their async counterparts with a <code>GetAwaiter().GetResult()</code> to force the code to wait for the outcome.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Using the async methods is strongly recommended. Use the sync methods only if you're using the PnP Core SDK in an already sync code base and async is not an option, if not use async. Using the sync methods can possibly lead to deadlocks when combined with applications using a <code>SynchronizationContext</code> like ASP.NET. If you see encounter deadlocks then wrapping the impacted code block in a <code>Task.Run(() =&gt; your code )</code> block should avoid the deadlock.</p>
</div>
<p>If you want to learn more about async programming checkout these resources:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/">Asynchronous programming with async and await</a></li>
<li><a href="https://medium.com/@deep_blue_day/long-story-short-async-await-best-practices-in-net-1f39d7d84050">Long Story Short: Async/Await Best Practices in .NET</a></li>
</ul>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>