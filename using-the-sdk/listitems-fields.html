<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Working with list item fields | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Working with list item fields | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/listitems-fields.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="working-with-list-item-fields">Working with list item fields</h1>

<p>When getting and setting list item values you'll need to work with the various field types SharePoint and PnP Core SDK support. Depending on the field type you'll need to work with different objects as you can see in below chapters.</p>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>The samples assume you've loaded a list into the variable <code>mylist</code>.</li>
<li>When referencing a field keep in mind that you need to use the field's <code>StaticName</code>. If you've created a field with name <code>Version Tag</code> then the <code>StaticName</code> will be <code>Version_x0020_Tag</code>, so you will be using <code>myItem[&quot;Version_x0020_Tag&quot;]</code> to work with the field.</li>
</ul>
</div>
<h2 id="text-and-multiline-text-fields">Text and Multiline text fields</h2>
<p>Working with text fields is one of the most common tasks and is easy as shown in the sample.</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a text field
values.Add(&quot;MyField&quot;, &quot;some text&quot;);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the text field
addedItem[&quot;MyField&quot;] = &quot;updated text&quot;;
// Or clear the text field
addedItem[&quot;MyField&quot;] = &quot;&quot;;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    addedItem[&quot;MyField&quot;] = &quot;PnP Rocks! &quot; + addedItem[&quot;MyField&quot;].ToString();
}
</code></pre>
<h2 id="number-and-currency-fields">Number and Currency fields</h2>
<p>Number fields can hold both integer and double values and when working with them you can add either an integer or double value, when processing a field value it's best to cast the number field to the type you need.</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a text field
values.Add(&quot;MyField&quot;, 25);
// or
values.Add(&quot;MyField&quot;, 25.123);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the text field
addedItem[&quot;MyField&quot;] = 100;
// Or clear the text field
addedItem[&quot;MyField&quot;] = 0;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value
if (addedItem[&quot;MyField&quot;] is double doubleValue)
{
    // do something with the field value as double
    addedItem[&quot;MyField&quot;] = addedItem[&quot;MyField&quot;] + doubleValue;
}
else
{
    // do something with the field value as integer 
    addedItem[&quot;MyField&quot;] = ((int)addedItem[&quot;MyField&quot;]) + 20;
}
</code></pre>
<h2 id="boolean-fields">Boolean fields</h2>
<p>Boolean fields are straightforward to use:</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a text field
values.Add(&quot;MyField&quot;, true);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the text field
addedItem[&quot;MyField&quot;] = false;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value
addedItem[&quot;MyField&quot;] = !((bool)addedItem[&quot;MyField&quot;]);
</code></pre>
<h2 id="datetime-fields">DateTime fields</h2>
<p>DateTime are slightly special to work with as a SharePoint site can be configured to use a different timezone then the process running the PnP Core SDK is. When you provide a DateTime value as input you need to provide the value in the current timezone running in the process or as UTC time. PnP Core SDK will, if needed, translate the time to the site's timezone before submitting. When reading DateTime values from the server you'll get time back as local time, unless you've used one of the <strong>DatesInUtc</strong> property when using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_GetItemsByCamlQueryAsync_PnP_Core_Model_SharePoint_CamlQueryOptions_">GetItemsByCamlQueryAsync</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_GetListDataAsStreamAsync_PnP_Core_Model_SharePoint_RenderListDataOptions_">GetListDataAsStreamAsync</a> approaches to read data.</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a text field
values.Add(&quot;MyField&quot;, DateTime.Now);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the DateTime field
addedItem[&quot;MyField&quot;] = DateTime.Now.Subtract(new TimeSpan(10,0,0,0));
// Or clear the text field
addedItem[&quot;MyField&quot;] = null;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    addedItem[&quot;MyField&quot;] = DateTime.Now - ((DateTime)addedItem[&quot;MyField&quot;]);
}
</code></pre>
<h2 id="calculated-fields">Calculated fields</h2>
<p>You never set or update calculated fields, you however might use it's output.</p>
<pre><code class="lang-csharp">// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    // Cast to the type you need
    var a = addedItem[&quot;MyField&quot;].ToString();
}
</code></pre>
<h2 id="choice-fields">Choice fields</h2>
<p>Setting a choice field is quite identical as working with text fields, you set a string value. Only difference is that the string you use to set a value needs to be known value in the list of choices unless you've configured the choice field to allow the user to add values via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.FieldChoiceMultiOptions.html#collapsible-PnP_Core_Model_SharePoint_FieldChoiceMultiOptions_FillInChoice">FillInChoice property</a>.</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a choice field
values.Add(&quot;MyField&quot;, &quot;Choice B&quot;);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the choice value
addedItem[&quot;MyField&quot;] = &quot;Choice A&quot;;
// Or clear the choice field
addedItem[&quot;MyField&quot;] = &quot;&quot;;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    var a = &quot;My choice was:&quot; + addedItem[&quot;MyField&quot;].ToString();
}
</code></pre>
<h2 id="multi-choice-fields">Multi choice fields</h2>
<p>A multi choice field allows a user to select multiple values from the offered choices, so to handle that you're working with a <code>List&lt;string&gt;</code>:</p>
<pre><code class="lang-csharp">// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a multi choice field
values.Add(&quot;MyField&quot;, new List&lt;string&gt; { &quot;Choice A&quot;, &quot;Choice B&quot; } );

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the multi choice field
addedItem[&quot;MyField&quot;] = new List&lt;string&gt; { &quot;Choice A&quot;, &quot;Choice B&quot; , &quot;Choice C&quot;, &quot;Choice D&quot;};
// Or clear the multi choice field
addedItem[&quot;MyField&quot;] = new List&lt;string&gt;();

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    foreach(var choice in (addedItem[&quot;MyField&quot;] as List&lt;string&gt;) )
    {
        // do something with the choice
    }
}
</code></pre>
<h2 id="url-fields">Url fields</h2>
<p>Url fields can be used to display a hyperlink with description or show an image from a hyperlink. Working with Url fields involves either directly instantiating an <code>FieldUrlValue</code> instance or working with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldUrlValue.html">IFieldUrlValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldUrlValue_System_String_System_String_">NewFieldUrlValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#PnP_Core_Model_SharePoint_IListItem_NewFieldUrlValue_PnP_Core_Model_SharePoint_IField_System_String_System_String_">NewFieldUrlValue method on the IListItem</a> methods to instantiate a FieldUrlValue class.</p>
<pre><code class="lang-csharp">// Add a url field
IField myField = await myList.Fields.AddUrlAsync(&quot;MyField&quot;, new FieldUrlOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Option A: instantiate a FieldUrlValue instance
values.Add(&quot;MyField&quot;, new FieldUrlValue(&quot;https://aka.ms/m365pnp&quot;, &quot;PnP Rocks!&quot;));

// Option B: Add a url field: using NewFieldUrlValue
values.Add(&quot;MyField&quot;, myField.NewFieldUrlValue(&quot;https://aka.ms/m365pnp&quot;, &quot;PnP Rocks!&quot;));

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the url field
(addedItem[&quot;MyField&quot;] as IFieldUrlValue).Url = &quot;https://aka.ms/pnp/coresdk&quot;;
// Or clear the url field
(addedItem[&quot;MyField&quot;] as IFieldUrlValue).Url = &quot;&quot;;
(addedItem[&quot;MyField&quot;] as IFieldUrlValue).Url = &quot;&quot;;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    string urlToUse = (addedItem[&quot;MyField&quot;] as IFieldUrlValue).Url;
}
</code></pre>
<h2 id="user-fields">User fields</h2>
<p>User fields hold a value to a user or group. Working with user fields involves either directly instantiating an <code>FieldUserValue</code> instance or working with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldUserValue.html">IFieldUserValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldUserValue_PnP_Core_Model_Security_ISharePointPrincipal_">NewFieldUserValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#collapsible-PnP_Core_Model_SharePoint_IListItem_NewFieldUserValue_PnP_Core_Model_SharePoint_IField_PnP_Core_Model_Security_ISharePointPrincipal_">NewFieldUserValue method on the IListItem</a> methods to instantiate a FieldUserValue class.</p>
<pre><code class="lang-csharp">// Add a user field
IField myField = await myList.Fields.AddUserAsync(&quot;MyField&quot;, new FieldUserOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Ensure a user can be used on a site
var myUser = await context.Web.EnsureUserAsync(&quot;ann@contoso.onmicrosoft.com&quot;);

// Option A: instantiate a FieldUserValue instance
values.Add(&quot;MyField&quot;, new FieldUserValue(myUser));

// Option B: Add a url field: using NewFieldUserValue
values.Add(&quot;MyField&quot;, myField.NewFieldUserValue(myUser));

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the url field
(addedItem[&quot;MyField&quot;] as IFieldUserValue).Principal = await context.Web.EnsureUserAsync(&quot;Everyone except external users&quot;);
// Or clear the url field
addedItem[&quot;MyField&quot;] = null;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    // Get the stored user lookup id value
    int userId = (addedItem[&quot;MyField&quot;] as IFieldUserValue).LookupId;
}
</code></pre>
<h2 id="multi-user-fields">Multi user fields</h2>
<p>Working with multi user fields builds on top of working with user fields, you still directly instantiating <code>FieldUserValue</code> instances or use the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldUserValue.html">IFieldUserValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldUserValue_PnP_Core_Model_Security_ISharePointPrincipal_">NewFieldUserValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#collapsible-PnP_Core_Model_SharePoint_IListItem_NewFieldUserValue_PnP_Core_Model_SharePoint_IField_PnP_Core_Model_Security_ISharePointPrincipal_">NewFieldUserValue method on the IListItem</a> methods, but since you need to store multiple users you need to manage them via an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldValueCollection.html">IFieldValueCollection</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It's important to create an <code>IFieldValueCollection</code> (e.g. via <code>IField.NewFieldValueCollection()</code> or via <code>new FieldValueCollection()</code>) per <code>IListItem</code> you're adding as the <code>IFieldValueCollection</code> handles the change tracking for that specific <code>IListItem</code>.</p>
</div>
<pre><code class="lang-csharp">// Add a multi user field
IField myField = await myList.Fields.AddUserMultiAsync(&quot;MyField&quot;, new FieldUserOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Ensure a user can be used on a site
var myUser1 = await context.Web.EnsureUserAsync(&quot;ann@contoso.onmicrosoft.com&quot;);
var myUser2 = await context.Web.EnsureUserAsync(&quot;pat@contoso.onmicrosoft.com&quot;);

// Add a multi user field

// Option A: instantiate a FieldValueCollection
var userCollection = new FieldValueCollection();
userCollection.Values.Add(new FieldUserValue(myUser1));
userCollection.Values.Add(new FieldUserValue(myUser2));

// Option B: use the NewFieldValueCollection method
var userCollection = myField.NewFieldValueCollection();
userCollection.Values.Add(myField.NewFieldUserValue(myUser1));
userCollection.Values.Add(myField.NewFieldUserValue(myUser2));

values.Add(&quot;MyField&quot;, userCollection);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the multi user field
var myUser3 = await context.Web.EnsureUserAsync(&quot;bob@contoso.onmicrosoft.com&quot;);
(addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Add(myField.NewFieldUserValue(myUser3));
// Or clear the multi user field
addedItem[&quot;MyField&quot;] = (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Clear();

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    foreach(IFieldUserValue user in (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values)
    {
        // Get the stored user lookup id value
        int userId = user.LookupId; 
    }    
}
</code></pre>
<h2 id="lookup-fields">Lookup fields</h2>
<p>Lookup fields point to another list item in another list. Working with lookup fields involves either directly instantiating an <code>FieldLookupValue</code> instance or working with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldLookupValue.html">IFieldLookupValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldLookupValue_System_Int32_">NewFieldLookupValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#PnP_Core_Model_SharePoint_IListItem_NewFieldLookupValue_PnP_Core_Model_SharePoint_IField_System_Int32_">NewFieldLookupValue method on the IListItem</a> methods to instantiate a FieldLookupValue class.</p>
<pre><code class="lang-csharp">IList sitePages = await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;);

// Add a lookup field
IField myField = await myList.Fields.AddLookupAsync(&quot;MyField&quot;, new FieldLookupOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
    LookupListId = sitePages.Id,
    LookupFieldName = &quot;Title&quot;,
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};


// Option A: instantiate a FieldLookupValue instance to add a lookup field to an item in the connected lookup list with id 4
values.Add(&quot;MyField&quot;, new FieldLookupValue(4));

// Option B: Add a lookup field using NewFieldLookupValue to add a lookup field to an item in the connected lookup list with id 4
values.Add(&quot;MyField&quot;, myField.NewFieldLookupValue(4));

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the lookup field
(addedItem[&quot;MyField&quot;] as IFieldLookupValue).LookupId = 8;
// Or clear the lookup field
addedItem[&quot;MyField&quot;] = null;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    // Get the stored user lookup id value
    int userId = (addedItem[&quot;MyField&quot;] as IFieldLookupValue).LookupId;
}
</code></pre>
<h2 id="multi-lookup-fields">Multi lookup fields</h2>
<p>Working with multi lookup fields builds on top of working with lookup fields, you still can directly instantiate <code>FieldLookupValue</code> instances or use the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldLookupValue.html">IFieldLookupValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldLookupValue_System_Int32_">NewFieldLookupValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#PnP_Core_Model_SharePoint_IListItem_NewFieldLookupValue_PnP_Core_Model_SharePoint_IField_System_Int32_">NewFieldLookupValue method on the IListItem</a> methods, but since you need to store multiple lookups you need to manage them via an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldValueCollection.html">IFieldValueCollection</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It's important to create an <code>IFieldValueCollection</code> (e.g. via <code>IField.NewFieldValueCollection()</code> or via <code>new FieldValueCollection()</code>) per <code>IListItem</code> you're adding as the <code>IFieldValueCollection</code> handles the change tracking for that specific <code>IListItem</code>.</p>
</div>
<pre><code class="lang-csharp">IList sitePages = await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;);

// Add a multi lookup field
IField myField = await myList.Fields.AddLookupMultiAsync(&quot;MyField&quot;, new FieldLookupOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
    LookupListId = sitePages.Id,
    LookupFieldName = &quot;Title&quot;,
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a multi lookup field

// Option A: instantiate a FieldValueCollection
var lookupCollection = new FieldValueCollection();
lookupCollection.Values.Add(new FieldLookupValue(4));
lookupCollection.Values.Add(new FieldLookupValue(8));

// Option B: use the NewFieldValueCollection method
var lookupCollection = myField.NewFieldValueCollection();
lookupCollection.Values.Add(myField.NewFieldLookupValue(4));
lookupCollection.Values.Add(myField.NewFieldLookupValue(8));

values.Add(&quot;MyField&quot;, lookupCollection);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the multi lookup field
(addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Add(myField.NewFieldLookupValue(12));
// Or clear the multi user field
addedItem[&quot;MyField&quot;] = (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Clear();

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    foreach(IFieldLookupValue lookup in (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values)
    {
        // Get the stored lookup id value
        int lookupId = lookup.LookupId; 
    }    
}
</code></pre>
<h2 id="taxonomy-fields">Taxonomy fields</h2>
<p>Taxonomy fields make it possible to select a value from a term set in your tenants managed metadata system. This involves either directly instantiating an <code>FieldTaxonomyValue</code> instance or working with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldTaxonomyValue.html">IFieldTaxonomyValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldTaxonomyValue_Guid_System_String_System_Int32_">NewFieldTaxonomyValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#PnP_Core_Model_SharePoint_IListItem_NewFieldTaxonomyValue_PnP_Core_Model_SharePoint_IField_Guid_System_String_System_Int32_">NewFieldTaxonomyValue method on the IListItem</a> methods to instantiate a FieldTaxonomyValue class.</p>
<pre><code class="lang-csharp">// Add a taxonomy field
IField myField = await myList.Fields.AddTaxonomyAsync(&quot;MyField&quot;, new FieldTaxonomyOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
    TermStoreId = new Guid(&quot;437b86fc-1258-45a9-85ea-87a29156ce3c&quot;),
    TermSetId = new Guid(&quot;d50ec969-cb27-4a49-839f-3c25d1d607d5&quot;)
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Option A: Add a taxonomy field to a term with the given id and label &quot;Dutch&quot; by directly instantiating a FieldTaxonomyValue class
values.Add(&quot;MyField&quot;, new FieldTaxonomyValue(new Guid(&quot;108b34b1-87af-452d-be13-881a29477965&quot;, &quot;Dutch&quot;)));

// Option B: Add a taxonomy field to a term with the given id and label &quot;Dutch&quot; using the NewFieldTaxonomyValue method
values.Add(&quot;MyField&quot;, myField.NewFieldTaxonomyValue(new Guid(&quot;108b34b1-87af-452d-be13-881a29477965&quot;, &quot;Dutch&quot;)));

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the taxonomy field
(addedItem[&quot;MyField&quot;] as IFieldTaxonomyValue).TermId = new Guid(&quot;8246e3c1-19ea-4b22-8ae3-df9cbc150a74&quot;);
(addedItem[&quot;MyField&quot;] as IFieldTaxonomyValue).Label = &quot;English&quot;;
// Or clear the taxonomy field
addedItem[&quot;MyField&quot;] = null;

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    // Get the stored term id value
    Guid termId = (addedItem[&quot;MyField&quot;] as IFieldTaxonomyValue).TermId;
}
</code></pre>
<h2 id="multi-taxonomy-fields">Multi taxonomy fields</h2>
<p>Working with multi taxonomy fields builds on top of working with taxonomy fields, you still can directly instantiate <code>FieldTaxonomyValue</code> instances or use the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldTaxonomyValue.html">IFieldTaxonomyValue interface</a> for field setting and the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IField.html#PnP_Core_Model_SharePoint_IField_NewFieldTaxonomyValue_Guid_System_String_System_Int32_">NewFieldTaxonomyValue method on the IField</a> or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItem.html#PnP_Core_Model_SharePoint_IListItem_NewFieldTaxonomyValue_PnP_Core_Model_SharePoint_IField_Guid_System_String_System_Int32_">NewFieldTaxonomyValue method on the IListItem</a> methods, but since you need to store multiple taxonomy fields you need to manage them via an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFieldValueCollection.html">IFieldValueCollection</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It's important to create an <code>IFieldValueCollection</code> (e.g. via <code>IField.NewFieldValueCollection()</code> or via <code>new FieldValueCollection()</code>) per <code>IListItem</code> you're adding as the <code>IFieldValueCollection</code> handles the change tracking for that specific <code>IListItem</code>.</p>
</div>
<pre><code class="lang-csharp">// Add a multi taxonomy field
IField myField = await myList.Fields.AddTaxonomyMultiAsync(&quot;MyField&quot;, new FieldTaxonomyOptions()
{
    Group = &quot;Custom Fields&quot;,
    AddToDefaultView = true,
    TermStoreId = new Guid(&quot;437b86fc-1258-45a9-85ea-87a29156ce3c&quot;),
    TermSetId = new Guid(&quot;d50ec969-cb27-4a49-839f-3c25d1d607d5&quot;)
});

// Create a list item key/value pair collection
Dictionary&lt;string, object&gt; values = new Dictionary&lt;string, object&gt;()
{
    { &quot;Title&quot;, &quot;Item1&quot; },
};

// Add a taxonomy field to a term with the given id and label &quot;Dutch&quot;
values.Add(&quot;MyField&quot;, myField.NewFieldTaxonomyValue(new Guid(&quot;108b34b1-87af-452d-be13-881a29477965&quot;, &quot;Dutch&quot;)));

// Option A: instantiate a FieldValueCollection
var taxonomyCollection = new FieldValueCollection();
taxonomyCollection.Values.Add(new FieldTaxonomyValue(new Guid(&quot;108b34b1-87af-452d-be13-881a29477965&quot;, &quot;Dutch&quot;)));
taxonomyCollection.Values.Add(new FieldTaxonomyValue(new Guid(&quot;8246e3c1-19ea-4b22-8ae3-df9cbc150a74&quot;, &quot;English&quot;)));

// Option B: use the NewFieldValueCollection method
var taxonomyCollection = myField.NewFieldValueCollection();
taxonomyCollection.Values.Add(myField.NewFieldTaxonomyValue(new Guid(&quot;108b34b1-87af-452d-be13-881a29477965&quot;, &quot;Dutch&quot;)));
taxonomyCollection.Values.Add(myField.NewFieldTaxonomyValue(new Guid(&quot;8246e3c1-19ea-4b22-8ae3-df9cbc150a74&quot;, &quot;English&quot;)));

values.Add(&quot;MyField&quot;, taxonomyCollection);

// Persist the item
var addedItem = await myList.Items.AddAsync(values);

// Update the multi taxonomy field
(addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Add(myField.NewFieldTaxonomyValue(new Guid(&quot;3f773e87-24c3-4d0d-a07f-96eb0c1e905e&quot;, &quot;French&quot;)));
// Or clear the multi taxonomy field
addedItem[&quot;MyField&quot;] = (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values.Clear();

// Update the item on the server
await addedItem.UpdateAsync();

// Using the value when not cleared
if (addedItem[&quot;MyField&quot;] != null)
{
    foreach(IFieldTaxonomyValue taxField in (addedItem[&quot;MyField&quot;] as IFieldValueCollection).Values)
    {
        // Get the stored term id value
        Guid termId = taxField.TermId;    
    }     
}
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>