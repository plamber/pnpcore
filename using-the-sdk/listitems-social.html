<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Commenting list item fields | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Commenting list item fields | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/plamber/pnpcore/blob/dev/docs/using-the-sdk/listitems-social.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="commenting-list-item-fields">Commenting list item fields</h1>

<p>List items can have comments and replies in SharePoint. This chapter explains how to enable or disable list item commenting and how to work with comments and replies.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Some of the samples assume you've loaded a list into the variable <code>mylist</code>, the code that shows how to do so is listed in the first examples.</p>
</div>
<h2 id="enablingdisabling-list-item-comments">Enabling/Disabling list item comments</h2>
<p>List items can have comments in SharePoint and using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItemBase.html#PnP_Core_Model_SharePoint_IListItemBase_SetCommentsDisabledAsync_System_Boolean_">SetCommentsDisabledAsync method</a> you can turn off commenting for a given list item. This method goes hand in hand with the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IListItemBase.html#PnP_Core_Model_SharePoint_IListItemBase_AreCommentsDisabledAsync">AreCommentsDisabledAsync</a> method to get the current commenting status of a list item.</p>
<pre><code class="lang-csharp">// Assume the fields where not yet loaded, so loading them with the list
var myList = context.Web.Lists.GetByTitle(&quot;My List&quot;, p =&gt; p.Title, p =&gt; p.Items, 
                                                     p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                                                   p =&gt; p.FieldTypeKind, 
                                                                                   p =&gt; p.TypeAsString, 
                                                                                   p =&gt; p.Title));
// Get the item with title &quot;Item1&quot;
var addedItem = myList.Items.AsRequested().FirstOrDefault(p =&gt; p.Title == &quot;Item1&quot;);

// Check if commenting was turned off
if (!(await addedItem.AreCommentsDisabledAsync()))
{
    // Turn commenting of the list item on
    await addedItem.SetCommentsDisabledAsync(false);
}
</code></pre>
<h2 id="getting-comments">Getting comments</h2>
<p>To work with list item comments you first need to get a reference to the list item comments collection. Once you've done that, you can enumerate the existing comments, add new comments or delete comments. Below code snippet shows how the comments can be enumerated.</p>
<pre><code class="lang-csharp">// Assume the fields where not yet loaded, so loading them with the list
var myList = context.Web.Lists.GetByTitle(&quot;My List&quot;, p =&gt; p.Title, p =&gt; p.Items, 
                                                     p =&gt; p.Fields.QueryProperties(p =&gt; p.InternalName, 
                                                                                   p =&gt; p.FieldTypeKind, 
                                                                                   p =&gt; p.TypeAsString, 
                                                                                   p =&gt; p.Title));
// Get the item with title &quot;Item1&quot;
var myItem = myList.Items.AsRequested().FirstOrDefault(p =&gt; p.Title == &quot;Item1&quot;);

// Get the comments for this list item
var comments = await myItem.GetCommentsAsync();

// Loop over the comments
foreach(var comment in comments.AsRequested())
{
    // Do something with the comment
}
</code></pre>
<h2 id="adding-a-comment">Adding a comment</h2>
<p>Once you've load a comments collection via one of the <code>GetComments</code> methods you can add new comments or delete comments.</p>
<pre><code class="lang-csharp">// Get the comments for this list item
var comments = await myItem.GetCommentsAsync();

// Add a comment
var comment = await comments.AddAsync(&quot;this is great&quot;);
</code></pre>
<h2 id="adding-a-reply-to-a-comment">Adding a reply to a comment</h2>
<p>Comments can also have replies and since the collection of replies is similar to the collections of comments to code to add a reply is the same:</p>
<pre><code class="lang-csharp">// Get the comments for this list item
var comments = await myItem.GetCommentsAsync();

// Add a comment
var comment = await comments.AddAsync(&quot;this is great&quot;);

// Add a reply to the comment
var reply = await comment.Replies.AddAsync(&quot;yes this is great!&quot;);
</code></pre>
<h2 id="removing-a-comment-or-reply">Removing a comment or reply</h2>
<p>Once you've load a comments collection via one of the <code>GetComments</code> methods you can delete comments and/or their replies using one of the <code>Delete</code> methods.</p>
<pre><code class="lang-csharp">// Load the comments with replies 
comments = await myItem.GetCommentsAsync(p =&gt; p.Author, p =&gt; p.Text, p =&gt; p.Replies);

// Get first comment
var firstComment = comments.AsRequested().First();

// Get first reply on the first comment
var firstCommentReply = firstComment.Replies.AsRequested().First();

// Delete the reply
await firstCommentReply.DeleteAsync();

// Delete the comment
await firstComment.DeleteAsync();
</code></pre>
<h2 id="likingunliking-comments-and-replies">Liking\Unliking comments and replies</h2>
<p>A comment or reply can be liked by the authenticated user, this is done using one of the <code>Like</code> or <code>Unlike</code> methods on either the comment or reply.</p>
<pre><code class="lang-csharp">// Load the comments with replies 
comments = await myItem.GetCommentsAsync(p =&gt; p.Author, p =&gt; p.Text, p =&gt; p.Replies);

// Get first comment
var firstComment = comments.AsRequested().First();

// Like the comment
await firstComment.LikeAsync();

// Unlike the comment
await firstComment.UnlikeAsync();

// Get first reply on the first comment
var firstCommentReply = firstComment.Replies.AsRequested().First();

// Like the reply
await firstCommentReply.LikeAsync();

// Unlike the reply
await firstCommentReply.UnlikeAsync();
</code></pre>
<h2 id="enumerating-likes-on-comments-and-replies">Enumerating likes on comments and replies</h2>
<p>A comment or reply can be liked by multiple persons and you can enumerate the &quot;likers&quot; by loading the <code>LikedBy</code> collection of a comment or reply.</p>
<pre><code class="lang-csharp">// Load the comments with replies 
comments = await myItem.GetCommentsAsync(p =&gt; p.Author, p =&gt; p.Text, p =&gt; p.Replies, p =&gt; p.LikedBy);

// Get first comment
var firstComment = comments.AsRequested().First();

// Enumerate the likes on this comment
foreach (var like on firstComment.LikedBy.AsRequested())
{
    // do something with the comment like information
}
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>